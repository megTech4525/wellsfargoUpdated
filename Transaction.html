<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WELLS FARGO(Transactions)</title>
    <link rel="stylesheet" href="./CSS/transaction.css" type="text/css">
    <link rel="stylesheet" href="./CSS/settings.css" type="text/css">
    <!-- <link rel="stylesheet" href="./CSS/transaction.css" type="text/css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==
    " crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <div class="header">
        <div class="logos">
         <!-- <img class="logo-png" src="./IMG/F.png" alt=""> -->
         <h1 class="logo-text">WellsFargo Banking</h1>
        </div>
         <!-- <div class="img" id="bottom-pics-2">
             <label for="upload">
                 <img src="./IMG/user-PROFILE.png" alt="click to upload" id="Profile-image" class="class-pics">
                 <input type="file" accept="image/jpeg, image/jpg, image/png" id="upload">
             </label>
             <div class="img-text">
                 <h3 class="client-name">Alexander Joshua</h3>
             </div>
         </div> -->
     </div>
    <div class="main-containers1">
        <header>
            <nav class="nav-link1">
                <div class="main-containers1">
                    <div class="sidecontainer">
                        <div class="img" id="bottom-pics">
                            <label for="upload">
                                <img src="./IMG/user-PROFILE.png" alt="click to upload" id="Profile-image">
                                <input type="file" accept="image/jpeg, image/jpg, image/png" id="upload">
                            </label>
                            <div class="img-text">
                                <h3 class="client-name" id="client-id"></h3>
                            </div>
                        </div><br>
                <li class="header-list">
                    <a class="head-link" href="./home.html"><i class="fa fa-home" aria-hidden="true"></i>      <span class="link-name">Home</span></a>
                </li><br>
    
                <li class="header-list">
                    <a class="head-link" href="./userProfile.html"><i class="fa fa-user-circle" aria-hidden="true"></i> <span class="link-name">User <span class="profile">Profile</span></span></a>
                </li><br>
    
                <li class="header-list" id="removal">
                    <a class="head-link" href="#"><i class="fa fa-bell" aria-hidden="true"></i><span class="link-name">Notifications</span></a>
                </li><br>
    
                <li class="header-list" id="removal">
                    <a class="head-link" href="#"><i class="fa fa-phone" aria-hidden="true"></i><span class="link-name">Customer <span class="profile">Care</span></span></a>
                </li><br>
    
                <li class="header-list">
                    <a class="head-link" href="./Transaction.html" id="transfer"><i class="fa fa-download"></i><span class="link-name">Transactions</span></a>
                </li><br>
    
                <li class="header-list">
                    <a class="head-link" href="./settings.html" id="transfer"><i class="fa fa-sliders" aria-hidden="true"></i><span class="link-name">Setting</span></a>
                </li><br>
                
                <li class="header-list" id="removal">
                    <a class="head-link" href="#"><i class="fa fa-refresh" aria-hidden="true"></i><span class="link-name">Refresh</span></a>
                </li><br> 
                </nav>
        </header>
       
        <!-- Transaction Section -->
         <section class="trans-section">
            <h1>Remaining Balance</h1>
           <div id="balance"></div><br><br>
           <div class="transaction-dashboard">
            <span id="shade"></span>
            <div class="intro-space">
                <label for="upload">
                 <img src="./IMG/user-PROFILE.png" alt="click to upload" id="Profile-image2" >
                 <input type="file" accept="image/jpeg, image/jpg, image/png" id="upload">
                </label>
            <span id="hello-user">Hello, <span id="user-name"></span></span>
              </div>
            
          <div class="trans-balances">
            <div class="balance">
                <div class="trans-headers">
                    <h3 class="trans-head">Total Balance</h3>
                    <a href="#table-responsive"><span id="transaction-history">Transaction History</span></a>
                </div><br>
                <span id="Total-balance">&dollar;0.00</span><br><br>
              
    
                <div class="trans-main">
                    <div class="transaction-icons">
                        <div class="addmoney">
                            <a href="./addMoney.html"><img src="./IMG/addMoney (1).png" class="trans-icon"></a>
                            
                            <div class="topUp-text">
                            Top Up
                        </div>
                            
                        </div>
        
                        <div class="transfermoney">
                            <a href="./transferForm.html"><img src="./IMG/transfer-in-out.png" class="trans-icon"></a>
                            <div class="addmoney-text1">
                                Transfer 
                            </div>
                        </div>
                            <div class="transfermoney">
                                <a href="./card.html"><img src="./IMG/credit-card.png" class="trans-icon"></a>
                                <div class="addmoney-text1">
                                    My Card
                                </div>
                            
        
                        </div>
                        <div class="convert">
                            <img src="./IMG/convert (1).png" class="trans-icon">
                            <div class="addmoney-text1">
                            Exchange
                        </div>
                            
                        </div>
                        </div>
        
                      
                </div>
                </div><br><br><br>
                <div class="table-responsive" id="table-responsive">
                    <table class="table-bordered" id="styled-table">
                        <thead>
                            <tr>
                            
                                <th id="recent-head">Recent Transactions</th>
                               
                            </tr>
                        </thead>
                        <tr>
                            <td></td>
                        </tr>
                        <tbody  id="transactionHistory">
                    </tbody>
                    </table>
                </div>
          </div>
            </div>

            <div class="support">
                <img src="./IMG/24-hours-support.png">
            </div>
         </section>
    </div> 

            <script src="./JS/script.js"></script>

            <script type="module" src="./JS/settings.js"></script>
            <script type="module" src="./JS/loadFunds.js"></script>
            <script type="module" src="./JS/index.js"></script>
    <script>


        const balanceDisplay = document.getElementById('Total-balance');
        const transactionHistoryContainer = document.getElementById('transactionHistory');
        
        // Display Balance
        function displayBalance() {
            const remainingBalance = parseFloat(localStorage.getItem('initialAmount')) || 0;
            balanceDisplay.innerHTML = `$${remainingBalance.toLocaleString(undefined, {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            })}`;
        }
        
        
        
        function displayTransactions() {
            // Retrieve transactions and deposits from localStorage
            let transactions = (() => {
                try {
                    return JSON.parse(localStorage.getItem('transactions')) || [];
                } catch (error) {
                    console.error("Failed to parse transactions:", error);
                    return [];
                }
            })();
        
            let deposits = (() => {
                try {
                    return JSON.parse(localStorage.getItem('DepositHistory')) || [];
                } catch (error) {
                    console.error("Failed to parse deposits:", error);
                    return [];
                }
            })();
        
            // Sort each group by date (newest first)
            transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
            deposits.sort((a, b) => new Date(b.date) - new Date(a.date));
        
            // Limit each group to the latest six entries
            const limitedTransactions = transactions.slice(0, 6);
            const limitedDeposits = deposits.slice(0, 3);
        
            // Clear the transaction history container
            transactionHistoryContainer.innerHTML = '';
        
            // Handle empty transactions
            if (limitedTransactions.length === 0 && limitedDeposits.length === 0) {
                transactionHistoryContainer.innerHTML = `
                    <tr>
                        <td colspan="4">No transactions or deposits found.</td>
                    </tr>`;
                return;
            }
        
            // Display Deposits Section
            if (limitedDeposits.length > 0) {
                const depositHeaderRow = document.createElement('tr');
                depositHeaderRow.innerHTML = `
                    <th colspan="4" style="text-align: center;">Recent Deposits</th>
                `;
                transactionHistoryContainer.appendChild(depositHeaderRow);
        
                limitedDeposits.forEach((item, index) => {
                    const row = document.createElement('tr');
        
                    // Create table cells
                    const indexCell = document.createElement('td');
                    const typeCell = document.createElement('td');
                    const amountCell = document.createElement('td');
                    const dateCell = document.createElement('td');
        
                    // Assign data to cells
                    indexCell.textContent = index + 1;
                    typeCell.textContent = "Deposit";
                    dateCell.textContent = new Date(item.date).toLocaleDateString();
        
                    // Format the amount
                    const amount = parseFloat(item.amount) || 0;
                    amountCell.textContent = `+$${amount.toLocaleString(undefined, {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    })}`;
                    amountCell.style.color = 'green';
                    amountCell.style.fontWeight = '900';
        
                    // Append cells to the row
                    row.appendChild(indexCell);
                    row.appendChild(typeCell);
                    row.appendChild(amountCell);
                    row.appendChild(dateCell);
        
                    // Append the row to the container
                    transactionHistoryContainer.appendChild(row);
                });
            }
        
            // Display Transactions Section
            if (limitedTransactions.length > 0) {
                const transactionHeaderRow = document.createElement('tr');
                transactionHeaderRow.innerHTML = `
                    <th colspan="4" style="text-align: center;">Recent Withdrawals</th>
                `;
                transactionHistoryContainer.appendChild(transactionHeaderRow);
        
                limitedTransactions.forEach((item, index) => {
                    const row = document.createElement('tr');
        
                    // Create table cells
                    const indexCell = document.createElement('td');
                    const typeCell = document.createElement('td');
                    const amountCell = document.createElement('td');
                    const dateCell = document.createElement('td');
        
                    // Assign data to cells
                    indexCell.textContent = index + 1;
                    typeCell.textContent = item.type;
                    dateCell.textContent = new Date(item.date).toLocaleDateString();
        
                    // Format the amount
                    const amount = parseFloat(item.amount) || 0;
                    const isWithdrawal = item.type.toLowerCase() === 'withdrawal';
                    amountCell.textContent = `${isWithdrawal ? '-' : '-'}$${Math.abs(amount).toLocaleString(undefined, {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2
                    })}`;
                    amountCell.style.color = isWithdrawal ? 'red' : 'red';
                    amountCell.style.fontWeight = '900';
        
                    // Append cells to the row
                    row.appendChild(indexCell);
                    row.appendChild(typeCell);
                    row.appendChild(amountCell);
                    row.appendChild(dateCell);
        
                    // Append the row to the container
                    transactionHistoryContainer.appendChild(row);
                });
            }
        }
        
        
        // Initialize on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            displayBalance();
            displayTransactions();
        
            // if(row.appendChild(FamountCell)){
            //         row.appendChild(amountCell).style.display == "none"
            //     }
        
        });
        
        
        
        
        
            
        </script>
        
            
        
</body>

</html>